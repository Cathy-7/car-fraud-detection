<div class="container">
  <h1>Car Fraud Risk Detection</h1>
  <p class="subtitle">Create car fraud risk formula based on NHTSA API</p>
  <form>
    <!--  Risk Element-->
    <div class="d-flex align-items-end justify-content-between">
      <div class="col me-auto">
        <label class="form-label fw-bold mb-0">Risk<span class="text-danger">*</span></label>
        <p class="text-information mb-2">Please select the risk level</p>
        <select class="form-select" aria-label="Risk"
                name="risk"
                [(ngModel)]="carFormula.risk">
          <option value="high"> high</option>
          <option value="medium"> medium</option>
          <option value="low"> low</option>
        </select>
      </div>
      <div class="ps-3">
        <button class="btn btn-primary" type="submit"
                [disabled]="
                (carFormula.risk === null && carFormula.makeName === null) ||
                (carFormula.risk === null && carFormula.year === null) ||
                (carFormula.risk === null && carFormula.fuelType === null) ||
                (carFormula.risk === null && carFormula.risk === null)"
                (click)="createFormulas(carFormula)">Create Formula
        </button>


      </div>
    </div>

    <p class="title mb-0 mt-3 fw-bold">Conditions<span class="text-danger">*</span></p>
    <p class="text-information mb-2">Please select at least 1 condition from the list below</p>

    <div class="d-flex flex-row flex-wrap align-items-bottom">
      <!--  Make Name Element-->
      <div class="col-6">
        <label class="form-label">Make Name</label>
        <select class="form-select" aria-label="List for Make Name"
                name="makeName"
                [ngModel]="carFormula.makeName"
                (ngModelChange)="updateCarModelList($event)">
          <option disabled>Select an option...</option>
          <option *ngFor="let data of carDetails" [value]="data.MakeName">{{data.MakeName}}</option>
        </select>
      </div>

      <!--  Model Name Element-->
      <div class="col-6 ps-3" *ngIf="carFormula.makeName !== null">
        <label class="form-label">Model Name</label>
        <select class="form-select" aria-label="List for Model Name"
                name="modelName"
                [(ngModel)]="carFormula.modelName">
          <option>Select an option...</option>
          <option *ngFor="let data of modelDetails" [value]="data.Model_Name">{{data.Model_Name}}</option>
        </select>
      </div>
    </div>
    <div class="d-flex flex-row flex-wrap align-items-bottom">
      <!--  Year Element-->
      <div class="col-6">
        <label class="form-label">Year</label>
        <input type="number" class="form-control" placeholder="Year"
               name="year"
               [(ngModel)]="carFormula.year">
      </div>

      <!--  Year Element-->
      <div class="col-5 ps-3" *ngIf="carFormula.year !== null">
        <label class="form-label">Year Comparison Type</label>
        <select class="form-select" aria-label="Comparison Type for year"
                name="yearComparisonType"
                [(ngModel)]="carFormula.yearComparisonType">
          <option value=">"> ></option>
          <option value="<"> <</option>
          <option value="="> =</option>
        </select>
      </div>
    </div>

    <!--  Fuel Type Element-->
    <div class="col-6">
      <label class="form-label">Fuel Type</label>
      <select class="form-select" aria-label="Fuel Type"
              name="fuelType"
              [(ngModel)]="carFormula.fuelType">
        <option value="diesel"> diesel</option>
        <option value="petrol"> petrol</option>
        <option value="electric"> electric</option>
      </select>
    </div>
  </form>

  <hr/>


  <div *ngIf="getFormulas.length > 0 && !errorMessage" class="table-responsive">
    <p class="title mb-0 mt-3 fw-bold">Formula(s)</p>
    <table class="table">
      <thead>
      <tr class="align-baseline">
        <th>Make Name</th>
        <th>Model Name</th>
        <th>Year Comparison Type</th>
        <th>Year</th>
        <th>Fuel Type</th>
        <th>Risk</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let formula of getFormulas">
        <td>{{formula[0].makeName}}</td>
        <td>{{formula[0].modelName}}</td>
        <td>{{formula[0].yearComparisonType}}</td>
        <td>{{formula[0].year}}</td>
        <td>{{formula[0].fuelType}}</td>
        <td>{{formula[0].risk}}</td>
        <td>
          <i class="fa fa-trash" aria-hidden="true" (click)="removeRow(formula[0])"></i>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="errorMessage">
    <div class="d-flex flex-col align-items-center justify-contents-center bg-light mt-8 p-20">
      <i class="fa fa-chain-broken font-size-56 mb-8" aria-hidden="true"></i>
      <p>Sorry, we're encountered an error {{errorMessage}}
        Please try again.
      </p>
    </div>
  </div>
  <div *ngIf="getFormulas.length < 1">
    <div class="d-flex flex-column align-items-center justify-contents-center p-4">
      <i class="fa fa-folder-open-o d-block fs-1" aria-hidden="true"></i>
      <p class="text-center">It seems like there's no formula(s) created yet.<br/>
      Please create a formula using the generator above.
      </p>
    </div>
  </div>
</div>


